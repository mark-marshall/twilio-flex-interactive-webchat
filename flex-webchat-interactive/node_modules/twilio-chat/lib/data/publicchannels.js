"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const index_1 = require("../util/index");
const restpaginator_1 = require("../restpaginator");
const channeldescriptor_1 = require("../channeldescriptor");
/**
 * Public channels collection
 * It's a cassandra-backed pull-based collection
 */
class PublicChannels {
    constructor(client, services, url) {
        this.client = client;
        this.services = services;
        this.url = url;
    }
    async getChannels(args = {}) {
        const url = new index_1.UriBuilder(this.url).arg('PageToken', args.pageToken).build();
        let response = await this.services.network.get(url);
        return new restpaginator_1.RestPaginator(response.body.channels.map(x => new channeldescriptor_1.ChannelDescriptor(this.client, x)), pageToken => this.getChannels({ pageToken }), response.body.meta.previous_token, response.body.meta.next_token);
    }
    async getChannelBySid(sid) {
        const url = new index_1.UriBuilder(this.url).path(sid).build();
        let response = await this.services.network.get(url);
        return new channeldescriptor_1.ChannelDescriptor(this.client, response.body);
    }
    async getChannelByUniqueName(uniqueName) {
        const url = new index_1.UriBuilder(this.url).path(uniqueName).build();
        let response = await this.services.network.get(url);
        return new channeldescriptor_1.ChannelDescriptor(this.client, response.body);
    }
}
exports.PublicChannels = PublicChannels;
