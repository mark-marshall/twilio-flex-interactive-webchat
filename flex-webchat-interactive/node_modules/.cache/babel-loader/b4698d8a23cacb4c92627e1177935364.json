{"ast":null,"code":"import _regeneratorRuntime from \"/Users/mmarshall/Desktop/flex-webchat-interactive/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/mmarshall/Desktop/flex-webchat-interactive/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"/Users/mmarshall/Desktop/flex-webchat-interactive/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _this = this,\n    _jsxFileName = \"/Users/mmarshall/Desktop/flex-webchat-interactive/src/components/Interactives.jsx\";\n\n// Package Imports\nimport React, { useState, useEffect, useRef } from 'react';\nimport { connect } from 'react-redux';\nimport { createTheme, ThemeProvider } from '@mui/material/styles'; // Component Imports\n\nimport Buttons from './Buttons';\nimport Dropdown from './Dropdown';\nimport Calendar from './Calendar'; // CSS Imports\n// import './Interactives.css';\n// Consts\n\nvar defaultCurInteractives = {\n  type: '',\n  options: []\n};\nvar theme = createTheme({\n  palette: {\n    overrides: {\n      root: {\n        color: 'orange'\n      }\n    },\n    primary: {\n      main: '#cbe0f6'\n    },\n    secondary: {\n      main: '#edf2ff'\n    }\n  }\n});\n\nvar Interactives = function Interactives(_ref) {\n  var manager = _ref.manager,\n      messageList = _ref.messageList,\n      channelSid = _ref.channelSid;\n  // Refs\n  var interactivesContainer = useRef(null); // State\n  // interface Interactives {\n  //   type: '' | 'buttons' | 'dropdown' | 'calendar',\n  //   options?: {'value': string, 'content': string}[],\n  //   timezone?: \"TZ database name\" as per: https://en.wikipedia.org/wiki/List_of_tz_database_time_zones\n  // }\n\n  var _useState = useState(defaultCurInteractives),\n      _useState2 = _slicedToArray(_useState, 2),\n      curInteractives = _useState2[0],\n      setCurInteractives = _useState2[1]; // UI\n\n\n  useEffect(function () {\n    if (messageList && messageList.length > 0 && !messageList[messageList.length - 1].isFromMe && messageList[messageList.length - 1].source.state.attributes.interactiveWebchatOptions) {\n      var lastMessageAttributes = messageList[messageList.length - 1].source.state.attributes.interactiveWebchatOptions;\n      setCurInteractives(lastMessageAttributes);\n    } else {\n      setCurInteractives(defaultCurInteractives);\n    }\n  }, [messageList]);\n  useEffect(function () {\n    if (curInteractives !== defaultCurInteractives) {\n      interactivesContainer.current.scrollIntoView();\n    }\n  }, [curInteractives]); // Functions\n\n  var sendMessage = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(message) {\n      var curChannel;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return manager.chatClient.getChannelBySid(channelSid);\n\n            case 2:\n              curChannel = _context.sent;\n              curChannel.sendMessage(message);\n\n            case 4:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function sendMessage(_x) {\n      return _ref2.apply(this, arguments);\n    };\n  }(); // Render\n\n\n  return /*#__PURE__*/React.createElement(React.Fragment, null, curInteractives !== defaultCurInteractives ? /*#__PURE__*/React.createElement(\"div\", {\n    ref: interactivesContainer,\n    className: \"interactive-container\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 9\n    }\n  }, curInteractives.type === 'buttons' ? /*#__PURE__*/React.createElement(ThemeProvider, {\n    theme: theme,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(Buttons, {\n    curInteractives: curInteractives,\n    sendMessage: sendMessage,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 15\n    }\n  })) : curInteractives.type === 'dropdown' ? /*#__PURE__*/React.createElement(Dropdown, {\n    curInteractives: curInteractives,\n    sendMessage: sendMessage,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 13\n    }\n  }) : curInteractives.type === 'calendar' ? /*#__PURE__*/React.createElement(Calendar, {\n    curInteractives: curInteractives,\n    sendMessage: sendMessage,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 13\n    }\n  }) : /*#__PURE__*/React.createElement(React.Fragment, null)) : /*#__PURE__*/React.createElement(React.Fragment, null));\n}; // Redux\n\n\nvar mapStateToProps = function mapStateToProps(state) {\n  return {\n    messageList: state.flex.chat.channels[state.flex.session.channelSid].messages,\n    channelSid: state.flex.session.channelSid\n  };\n};\n\nexport default connect(mapStateToProps)(Interactives);","map":{"version":3,"sources":["/Users/mmarshall/Desktop/flex-webchat-interactive/src/components/Interactives.jsx"],"names":["React","useState","useEffect","useRef","connect","createTheme","ThemeProvider","Buttons","Dropdown","Calendar","defaultCurInteractives","type","options","theme","palette","overrides","root","color","primary","main","secondary","Interactives","manager","messageList","channelSid","interactivesContainer","curInteractives","setCurInteractives","length","isFromMe","source","state","attributes","interactiveWebchatOptions","lastMessageAttributes","current","scrollIntoView","sendMessage","message","chatClient","getChannelBySid","curChannel","mapStateToProps","flex","chat","channels","session","messages"],"mappings":"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","sourcesContent":["// Package Imports\nimport React, { useState, useEffect, useRef } from 'react';\nimport { connect } from 'react-redux';\n\nimport { createTheme, ThemeProvider } from '@mui/material/styles';\n\n// Component Imports\nimport Buttons from './Buttons';\nimport Dropdown from './Dropdown';\nimport Calendar from './Calendar';\n\n// CSS Imports\n// import './Interactives.css';\n\n// Consts\nconst defaultCurInteractives = { type: '', options: [] };\n\nlet theme = createTheme({\n  palette: {\n    overrides: {\n      root: {\n        color: 'orange',\n      },\n    },\n    primary: {\n      main: '#cbe0f6',\n    },\n    secondary: {\n      main: '#edf2ff',\n    },\n  },\n});\n\nconst Interactives = ({ manager, messageList, channelSid }) => {\n  // Refs\n  const interactivesContainer = useRef(null);\n\n  // State\n\n  // interface Interactives {\n  //   type: '' | 'buttons' | 'dropdown' | 'calendar',\n  //   options?: {'value': string, 'content': string}[],\n  //   timezone?: \"TZ database name\" as per: https://en.wikipedia.org/wiki/List_of_tz_database_time_zones\n  // }\n  const [curInteractives, setCurInteractives] = useState(\n    defaultCurInteractives\n  );\n\n  // UI\n  useEffect(() => {\n    if (\n      messageList &&\n      messageList.length > 0 &&\n      !messageList[messageList.length - 1].isFromMe &&\n      messageList[messageList.length - 1].source.state.attributes\n        .interactiveWebchatOptions\n    ) {\n      const lastMessageAttributes =\n        messageList[messageList.length - 1].source.state.attributes\n          .interactiveWebchatOptions;\n      setCurInteractives(lastMessageAttributes);\n    } else {\n      setCurInteractives(defaultCurInteractives);\n    }\n  }, [messageList]);\n\n  useEffect(() => {\n    if (curInteractives !== defaultCurInteractives) {\n      interactivesContainer.current.scrollIntoView();\n    }\n  }, [curInteractives]);\n\n  // Functions\n  const sendMessage = async (message) => {\n    const curChannel = await manager.chatClient.getChannelBySid(channelSid);\n    curChannel.sendMessage(message);\n  };\n\n  // Render\n  return (\n    <>\n      {curInteractives !== defaultCurInteractives ? (\n        <div ref={interactivesContainer} className=\"interactive-container\">\n          {curInteractives.type === 'buttons' ? (\n            <ThemeProvider theme={theme}>\n              <Buttons\n                curInteractives={curInteractives}\n                sendMessage={sendMessage}\n              />\n            </ThemeProvider>\n          ) : curInteractives.type === 'dropdown' ? (\n            <Dropdown\n              curInteractives={curInteractives}\n              sendMessage={sendMessage}\n            />\n          ) : curInteractives.type === 'calendar' ? (\n            <Calendar\n              curInteractives={curInteractives}\n              sendMessage={sendMessage}\n            />\n          ) : (\n            <></>\n          )}\n        </div>\n      ) : (\n        <></>\n      )}\n    </>\n  );\n};\n\n// Redux\nconst mapStateToProps = (state) => {\n  return {\n    messageList:\n      state.flex.chat.channels[state.flex.session.channelSid].messages,\n    channelSid: state.flex.session.channelSid,\n  };\n};\n\nexport default connect(mapStateToProps)(Interactives);\n"]},"metadata":{},"sourceType":"module"}