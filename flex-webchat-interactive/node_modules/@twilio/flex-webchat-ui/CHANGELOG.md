# Changelog

All notable changes to this project will be documented in this file.

## [Unreleased]

## 2.9.1

### Changed

-   Bumped Handlebars version to 4.7.7

## 2.9.0

### Changed

-   Markdown parser: Add regex check for markdown links with a space between the text and the url e.g. [Foo] (www.foo.com)
-   Markdown parser: Remove regex address tables, checkbox and multi-row blockquotes

## 2.7.1

### Dependencies updated

-   [axios] To version 0.21.1.

## 2.7.0

### Changed

-   Released a new version of the markdown engine

## 2.6.1

### Fixed

-   Bug fix for file attachment drag and drop.

## 2.6.0

### Fixed

-   Changing `charLimit` property of the `MessagingCanvas` is now working.
-   Chat link parser now recognise domain and params not separated by a slash. For instance: "http://flex.twilio.com?test=true".

### Changed

-   Bundle now imports only required component from Material UI

### Removed

-   Removed unused React Draggable support

## 2.5.0

### Added

-   Introducing new boolean property in `MainContainer` component called `showNotificationBar` which by default is `true`.
    It's used to render notification bar below main header.

### Fixed

-   CSS font style fix for title child (key=text) in MessageCanvasTray.

## 2.4.0

### Dependencies updated

-   [handlebars] To version 4.7.3

### Added

-   Yarn support

### Fixed

-   Improved chat message input rendering performance by debouncing store update on keypress.
-   Illegal unquoted character error when submitting WebChat message via Enter button

## 2.3.1

### Fixed

-   Highlight URLs only if they are not part of another string
-   Fix Handlebars 4.7.0+ errors
-   Notify user for new chat message only if they are participant

## 2.3.0

### Fixed

-   Attempt to create a manager instance using incompatible redux store will now throw an error instead of string

## 2.2.1

### Added

-   Added a `markdownSupport` key to config to enable/disable markdown in chat input. E.G

```javascript
const config = {
    // ...
    markdownSupport: {
        enabled: true
    }
    // ..
};
```

## 2.2.0

### Changed

-   The Message Input component’s `useLocalState` flag is obsolete

## 2.1.2

### Fixed

-   `DynamicForm` email validation now correctly supports 2-chars domains, subdomains.

### Added

-   Deprecated `manager.configuration` setter. Now you can use `manager.updateConfig(config)` to update configuration.

## 2.1.1

### Fixed

-   Bundled code now transpiles to IE11-compatible version. If you're integrating Flex NPM package into your application, you also have to include polyfills for required features at the top of your application's entry point. For instance, in case of `create-react-app`:

```
import 'react-app-polyfill/ie11';
import 'react-app-polyfill/stable';
```

## 2.1.0

### Dependencies updated

-   [twilio-chat] to version 3.2.3
-   [@material-ui/core] to version 3.9.3

### Changed

-   General Flex UI styles (like headers, paragraphs or links) are now applied only to HTML elements that have a class starting with `Twilio` or their direct descendants without any class
-   CSS reset is now longer applied automatically. Use new `resetCSS` method from `@twilio/frame-ui` package if you would like to apply it.

### Added

-   Aria props properties to the following component to support accessibility:

    -   EntryPoint:
        -   `collapsedIconAriaProps` • AriaProps • Collapsed icon aria props (`{ariaLabel: "Click here to open Web Chat and get help."}` by default).
        -   `openedIconAriaProps` • AriaProps • Opened icon aria props (`{ariaLabel: "Hide Chat"}` by default).

    Example on how to set aria attributes:

    ```
    FlexWebChat.EntryPoint.defaultProps.collapsedIconAriaProps = {
        ariaLabel: "Entry point collapsed",
        ariaLive: FlexWebChat.AriaLive.Assertive
    };

    FlexWebChat.EntryPoint.defaultProps.openedIconAriaProps = {
        ariaLabel: "Entry point opened",
        ariaLive: FlexWebChat.AriaLive.Polite
    };
    ```

### Removed

-   Unused `AppState.tryGet` method

### Fixed

-   `EntryPoint.tagline` was not changeable via config's ComponentProps.
-   Polyfills for IE11 support

## 2.0.0

### Fixed

-   Add a character limit of 32kB to `MessagingCanvas`

### Changed

-   Global `Twilio.Flex` renamed to `Twilio.FlexWebChat`.
-   `Twilio.FlexWebChat.createWebChat` creates an instance of Web Chat, but does not render automatically anymore. Use `Twilio.FlexWebChat.renderWebChat` to render automatically (like `createWebChat` used to do).
-   Updated preEngagement view.
-   Now `startEngagementOnInit` by default is `true` and the default `preEngagementConfig` is removed.
-   Added `InvalidPreEngagementCanvas` which is shown if no `preEngagementConfig` is provided when `startEngagementOnInit` is `false`.
-   Updated styles of webchat.
-   EntryPoint props changed to:
    -   `hideTaglineWhenExpanded` • boolean • Choose whether to hide the `tagline` when chat box is expanded.
    -   `iconClosed` • string | React.ReactNode • name of the icon to be shown when chat box is closed.
    -   `iconExpanded` • string | React.ReactNode • name of the icon to be shown when chat box is expanded.
    -   `tagline` • ReactChild • tagline content.
-   Added footer text part of pre-engagement config. Use `preEngagementConfig.footerLabel` to set it.
-   Use theme's `PreEngagementCanvas.Footer` to style pre-engagement form footer text.
-   `logLevel` by default is set to `error`.
-   Chat's `MessageInput` now uses `localState` by default. This will allow the developer to store the message input value in the component state instead of the Redux state.

**Please note:** `MessageInput.defaultProps.useLocalState` should be set to false if there's the intention of changing the input value using the "SetInputText" action.

-   Group engagement stage constants in an Enum `EngagementStage`

### Added

-   Set `predefinedMessage` defaultProp to `Messaging` to display and customise a predefined initial message to the user.
-   Added `sdkOptions.chat` key to configuration object that can be used to pass options to chat SDK during initialization.
-   New function `Twilio.FlexWebChat.renderWebChat` added to initialize and render Web Chat automatically.
    To create and render Web Chat automatically (without configuring anything);

```
Twilio.FlexWebChat.renderWebChat(configuration);
```

To create, configure and render WebChat manually:

```
Twilio.FlexWebChat.createWebChat(configuration)
    .then((webChat) => {
        // do something with webChat.manager for example

        webChat.init(); // to initialize and render
    });
```

### Removed

-   Removed the following **EntryPoint** props in favour of theme's `EntryPoint.Container`
    -   `entryPointStyle`
    -   `entryPointBorderStyle`
    -   `entryPointClassName`
    -   `widgetClassName`
    -   `entryPointSize`
    -   `entryPointLocation`
    -   `bottom`
    -   `right`
    -   `background`
    -   `color`
-   `configure()` method from returned `Twilio.Flex.createWebChat` object. Use `manager.configuration` member to set the configuration;
-   `setEngagementStage()` method from returned `Twilio.Flex.createWebChat` object. Engagement stage is determined by configuration and chat state.
-   Unused `Config.canvasBottom` prop
-   Unused `Config.postEngagementConfig` prop
-   Unused `Config.timeoutEngagementConfig` prop
-   Unused `SessionState.sessionData` prop
-   Unused `SessionState.waitingTimeoutSeconds` prop
-   Unused `SessionState.preEngagementReady` prop
-   Unused engagement stages
-   Unused Session Actions

## 1.2.0

### Added

-   Custom redux store support added:

```
const reducers = combineReducers({
    flex: WebchatReducer,
    app: appReducer
});

const store = createStore(
    reducers,
    compose(
        applyWebchatMiddleware()
    )
);

FlexWebChat.Manager.create(config, store)
    .then(manager => {
        ReactDOM.render(
            <Provider store={store}>
                <FlexWebChat.ContextProvider manager={manager}>
                    <FlexWebChat.RootContainer />
                </FlexWebChat.ContextProvider>
            </Provider>,
            document.getElementById("container")
        );
    });
```

### Fixed

-   TypeScript definitions for TS based projects.
-   New chat was not created if previously used chat channel was deleted.

## 1.1.0

### Added

-   User's friendly name default to `Anonymous` and can be defined through context argument as `friendlyName` field

### Changed

-   The `startEngagementOnInit` option now disables pre-engagement form

### Fixed

-   Fixed width and spacing in `preEngagementForm`.
