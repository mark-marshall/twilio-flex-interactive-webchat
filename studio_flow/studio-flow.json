{
  "description": "Bot flow for creating a Flex webchat task",
  "states": [
    {
      "name": "Trigger",
      "type": "trigger",
      "transitions": [
        {
          "next": "Greeting",
          "event": "incomingMessage"
        },
        {
          "event": "incomingCall"
        },
        {
          "event": "incomingRequest"
        },
        {
          "event": "incomingParent"
        }
      ],
      "properties": {
        "offset": {
          "x": 0,
          "y": -10
        }
      }
    },
    {
      "name": "SendMessageToAgent",
      "type": "send-to-flex",
      "transitions": [
        {
          "event": "callComplete"
        },
        {
          "event": "failedToEnqueue"
        },
        {
          "event": "callFailure"
        }
      ],
      "properties": {
        "offset": {
          "x": -160,
          "y": 750
        },
        "workflow": "WW2b6416efb8017ee99587adb6e04b0ea7",
        "channel": "TCf29fdc415728ccd80e94cbc609022491",
        "attributes": "{\"name\": \"{{trigger.message.ChannelAttributes.from}}\", \"channelType\": \"{{trigger.message.ChannelAttributes.channel_type}}\", \"channelSid\": \"{{trigger.message.ChannelSid}}\"}"
      }
    },
    {
      "name": "Greeting",
      "type": "send-and-wait-for-reply",
      "transitions": [
        {
          "next": "FruitOptions",
          "event": "incomingMessage"
        },
        {
          "event": "timeout"
        },
        {
          "event": "deliveryFailure"
        }
      ],
      "properties": {
        "offset": {
          "x": 50,
          "y": 200
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "Fresh Fruit Bot",
        "attributes": "{\n \"interactiveWebchatOptions\": {\n \"type\": \"buttons\",\n \"options\": [{\"uuid\": \"78d7ffc3-bdb5-40dd-a455-3ef352fab140\", \"content\": \"I want to place an order ü•ù\",  \"value\": \"I want to place an order\"},{\"uuid\": \"e11ef994-4a61-4a0c-aa5f-0ae4d93b91cf\", \"content\": \"I want to cancel my susbcription üò•\", \"value\": \"I want to cancel my subscription\"}, {\"uuid\": \"34506dc-76f5-4286-a0c9-3f63388a38b1\", \"content\": \"Something else ü§î\", \"value\": \"Something else\"}]\n  }\n  }",
        "body": "Please briefly explain why you've contacted us today....",
        "timeout": "3600"
      }
    },
    {
      "name": "FruitOptions",
      "type": "send-and-wait-for-reply",
      "transitions": [
        {
          "next": "DateOptions",
          "event": "incomingMessage"
        },
        {
          "event": "timeout"
        },
        {
          "event": "deliveryFailure"
        }
      ],
      "properties": {
        "offset": {
          "x": -140,
          "y": 440
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "Fresh Fruit Bot",
        "attributes": "{\n \"interactiveWebchatOptions\": {\n \"type\": \"dropdown\",\n \"options\": [{\"uuid\": \"ccfbe80d-891e-4424-9a41-897ffdbb3932\", \"content\": \"Berry Bonanza ü´ê\",  \"value\": \"Berry Bonanza\"},{\"uuid\": \"d2de75d0-5006-4c9a-8ce9-956d14a149e2\", \"content\": \"Seasonal Stapes ‚òÄÔ∏è\", \"value\": \"Seasonal Staples\"}, {\"uuid\": \"c3601efc-17b1-4978-8c93-964475bcdad7\", \"content\": \"Organic Delights üåø\", \"value\": \"Organic Delights\"}]\n  }\n  }",
        "body": "Which box would you like to order?",
        "timeout": "3600"
      }
    },
    {
      "name": "DateOptions",
      "type": "send-and-wait-for-reply",
      "transitions": [
        {
          "next": "SendMessageToAgent",
          "event": "incomingMessage"
        },
        {
          "event": "timeout"
        },
        {
          "event": "deliveryFailure"
        }
      ],
      "properties": {
        "offset": {
          "x": 170,
          "y": 590
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "Fresh Fruit Bot",
        "attributes": "{\n \"interactiveWebchatOptions\": {\n \"type\": \"calendar\",\n\"timezone\": \"Antarctica/McMurdo\"\n  }\n  }",
        "body": "Which date would you like your box to be delivered?",
        "timeout": "3600"
      }
    }
  ],
  "initial_state": "Trigger",
  "flags": {
    "allow_concurrent_calls": true
  }
}
